### Colocalization Analysis

This is the first step of the process, and is required to run the rest of the code in our project. Due to the long nature of the process, we have also included our results. To begin, clone the entire repository (including the data files), and then open the notebook and run it. 

Downloading the data:
- All of the data is retrieved from a publication in the GWAS Catalog: https://www.ebi.ac.uk/gwas/publications/32589924
- For each diseases of interest, please navigate to 'Full summary statistics' tab, then do 'FTP Download', and download the tsv file (example: 'GCST010774_buildGRCh37.tsv' for essential hypertension). This file should be around 3.6 GB.
- After downloading all files of interest, proceed with the next step.

Running coloclization.ipynb:
- The first step is to configure which disease you want to run. After doing so, manually select the diseases of choice and modify the code by adding the disease name and the corresponding disease file. This should be done third and fourth cells in the notebook.
- After this, follow each cell step by step, and run the cells accordingly.
- Optional: once you reach the 'batch processing' step, you can configure batches to run the disease in. Be wary, because as configured, the code will run the code for every single gene, which could take several hours.
- Once the cell which converts the data to a csv file called 'results_df_unique.csv' is reached, the data will be complete, and saved locally. The following cells are not necessary, and are only for manual configuration of the batch processing.
- The 'results_df_unique.csv' should be renamed, as it represents the results for just one of the diseases.
- Be sure to run this same notebook for every single disease of interest.
- Following this, open the notebook 'disease_coloc_aggregate.ipynb', and run all of the cells. This should just combine all of the disease data into one single results file, called 'diseases_df.csv'.
- Congratulations, the colicalization analysis is complete!

### Principal Component Analysis and Clustering

Principal component analysis and clustering is the next step, and is performed on the colocalization results ('diseases_df' in the GitHub). 

Running PCA:
- Open the 'PCA_visualizations.ipynb' notebook, and run the cells accordingly. This notebook essentially loads in the data, does some processing, and configures the principal components.
- Aftering configuring the principal components, several different plots and visualizations are generated, including a scree plot, biplot, scatter plot highlighted with clusters, and a heatmap of diseases versus clusters.

Running Clustering:
- Open the 'cluster_visualizations.ipynb' notebook, and run the cells accordingly. This notebook loads in the data, processes it, and performs hierarchical clustering on the colocalization results.
- It also creates several visualizations out of the hierarchical clusters, including a dendrogram and a heatmap of the diseases versus the genes (includes the clusters).

### Gene Set Enrichment Analysis


Primary inputs for our GSEA are a .chip file of significant gene outputs from PCA and publicly available Hallmark gene sets. Our analysis began with the data manipulation, as seen in the "GSEA.ipynb" Jupyter notebook to convert the Hallmark set into a format usable by GSEA.

To run GSEA.ipynb:
- Download the entire repository (including the data files), and then open the notebook and run it.
- Follow each cell step by step, and by the end, the appropriately formatted data should be located in a new file called "gene_exp_format_common.txt".
- Download this file locally, as it will be an input into the GSEA software.

To use GSEA:
- Install the GSEA software here: https://www.gsea-msigdb.org/gsea/downloads.jsp.
- Follow download instructions, and open the application.
- Under the 'Load data' tab, upload the gene expression data ("gene_exp_format_common.txt") and the label data ("age.cls").
    - The gene expression data should be generated by the notebook locally, and age.cls is included in the github.
- Go to the 'Run GSEA' tab, and load the following data
    - expression dataset: "gene_exp_format_common.txt"
    - phenotype labels: "age.cls"
- Select the gene sets database
    - Hallmark gene set: ("h.all.v2023.2.Hs.symbols.gmt")
- Select the menu for the "Collapse/Remap to gene symbols"
    - change value to "No_Collapse"

If the GSEA is completed, you will see "Running" then "Success" at the bottom left of the screen.
These results include enrichment scores and charts for each gene set, as well as data for each individual gene. 
